<div id="package_header" class="header">
        <img *ngIf="package.package_avatar" class="logo" src="{{package.package_avatar ? iconUrl + package.package_avatar : ''}}">
        <mat-icon class="logo" *ngIf="!package.package_avatar">view_in_ar</mat-icon>
        <span class="heading" >
            <span *ngIf="!packageEdit">{{package.package_name}}</span> 
                <mat-form-field *ngIf="packageEdit" appearance="legacy">
                        <input matInput style="text-align: center;"
                        type="text" [(ngModel)]="package.package_name">
                      </mat-form-field>
            <button mat-button (click)="edit('package')"
             *ngIf="!packageEdit" color="primary"><mat-icon>edit</mat-icon></button>
            <button mat-button (click)="edit('package')"
             *ngIf="packageEdit" color="warn"><mat-icon>close</mat-icon></button>
        </span>
        <button (click)="removePackage()"
        matTooltip="Delete Package" mat-fab color="warn"><mat-icon>delete_forever</mat-icon></button>
        <br><br>
        <span class="sub-heading" >( Package Id: {{package.package_id}} )</span><br>
        </div>
    <hr><br><br>
<div class="row">
    <div class="col-4 package_info">
        <mat-icon class="info" style="color: cornflowerblue;">person</mat-icon><br>
        <strong>Total Users</strong><br><br>
        <strong *ngIf="!usersEdit" class="info-text">{{package.total_users}}</strong>
        <mat-form-field class="info-text" *ngIf="usersEdit" appearance="legacy">
                <input matInput style="text-align: center;"
                type="text" [(ngModel)]="package.total_users">
              </mat-form-field>
    <button mat-button (click)="edit('users')"
     *ngIf="!usersEdit" color="primary"><mat-icon>edit</mat-icon></button>
    <button mat-button (click)="edit('users')"
     *ngIf="usersEdit" color="warn"><mat-icon>close</mat-icon></button>
    </div>
    <div class="col-4 package_info">
            <mat-icon class="info" style="color : green">storage</mat-icon><br>
            <strong>Total Space</strong><br><br>
            <strong *ngIf="!spaceEdit" class="info-text">{{package.total_media_disk_space/1024 > 1 ? (package.total_media_disk_space/1024).toFixed(2)  +
                    " GB" : package.total_media_disk_space + " MB"}}</strong>
                    <mat-form-field class="info-text" *ngIf="spaceEdit" appearance="legacy">
                            <input matInput style="text-align: center;"
                            type="text" [(ngModel)]="package.total_media_disk_space">
                            <span matSuffix>MB</span>
                          </mat-form-field>
                <button mat-button (click)="edit('space')"
                 *ngIf="!spaceEdit" color="primary"><mat-icon>edit</mat-icon></button>
                <button mat-button (click)="edit('space')"
                 *ngIf="spaceEdit" color="warn"><mat-icon>close</mat-icon></button>
    </div>
    <div class="col-4 package_info">
            <mat-icon class="info" style="color: crimson;">subscriptions</mat-icon><br>
            <strong>Subscription Categories</strong><br><br>
            <strong *ngIf="!subscriptionEdit" class="info-text">{{package.subscription_categories}}</strong>
            <mat-form-field class="info-text" *ngIf="subscriptionEdit" appearance="legacy">
                <input matInput style="text-align: center;"
                type="text" [(ngModel)]="package.subscription_categories">
            </mat-form-field>
        <button mat-button (click)="edit('subscription')"
         *ngIf="!subscriptionEdit" color="primary"><mat-icon>edit</mat-icon></button>
        <button mat-button (click)="edit('subscription')"
         *ngIf="subscriptionEdit" color="warn"><mat-icon>close</mat-icon></button>
    </div>
</div>
<hr><br><br>
<button (click)=" showHidePremiumForm()"
mat-raised-button color="primary" style="width : 300px; height: 60px;"><mat-icon> shop_two </mat-icon> Add a Premium</button>
<br>
<hr>
<br>
<form *ngIf="showPremium" [formGroup]="addPremiumForm" ngSubmit="addPremium()">
    <mat-form-field class="form-group" appearance="outline" style="width : 90%">
        <mat-label>Premium Name</mat-label>
        <input matInput formControlName="premium_name" placeholder="Enter your premium name" required >
        <mat-hint>Premium name should not exceed 50 characters</mat-hint>
        <mat-hint align="end">{{premium_name.value.length}}/50</mat-hint>
        <mat-error *ngIf="premium_name.hasError('required')">Value is required</mat-error>
        <mat-error *ngIf="premium_name.hasError('maxLength')">Max Character Limit Exceeded</mat-error>
    </mat-form-field><br>
    <mat-form-field class="form-group" appearance="outline" style="width : 90%">
        <mat-label>Premium Description</mat-label>
        <textarea matInput formControlName="premium_description" placeholder="Enter your premium description"></textarea>
        <mat-hint>Premium name should not exceed 100 characters</mat-hint>
        <mat-hint align="end">{{premium_description.value.length}}/100</mat-hint>
        <mat-error *ngIf="premium_description.hasError('maxLength')">Max Character Limit Exceeded</mat-error>
    </mat-form-field><br>
    <mat-checkbox formControlName="is_splitwise">Is Premium Splitwise ?</mat-checkbox><br>
    <mat-form-field *ngIf="is_splitwise.value" class="form-group" appearance="outline">
        <mat-label>Splitwise Category</mat-label>
        <mat-select formControlName="splitwise_category" required>
            <mat-option value="daily">Daily</mat-option>
            <mat-option value="weekly">Weekly</mat-option>
            <mat-option value="monthly">Monthly</mat-option>
            <mat-option value="yearly">Yearly</mat-option>
        </mat-select>
        <mat-error>Value is required</mat-error>
    </mat-form-field>
    <mat-form-field *ngIf="is_splitwise.value" class="form-group" appearance="outline">
        <mat-label>
            Splitwise Price
        </mat-label>
        <input matInput type="number" formControlName="splitwise_price"  required>
        <span style="font-size: 15px;" matPrefix>&#x20B9; </span>
        <mat-hint>Enter {{splitwise_category.value}} price between 1 and 100000000</mat-hint>
        <mat-error *ngIf="splitwise_price.hasError('required')">Value is required</mat-error>
        <mat-error *ngIf="splitwise_price.hasError('min')">Minimum price should be 1</mat-error>
        <mat-error *ngIf="splitwise_price.hasError('max')">Maximum price should be less than or equal to 100000000</mat-error>
    </mat-form-field>
    <mat-form-field  *ngIf="is_splitwise.value"  class="form-group" appearance="outline">
        <mat-label>Total Premium Price</mat-label>
        <input  matInput type="number" formControlName="total_premium_price"  required>
        <span style="font-size: 15px;" matPrefix>&#x20B9; </span>
        <mat-hint>Enter a price between 1 and 100000000</mat-hint>
        <mat-error *ngIf="total_premium_price.hasError('required')">Value is required</mat-error>
        <mat-error *ngIf="total_premium_price.hasError('min')">Minimum price should be 1</mat-error>
        <mat-error *ngIf="total_premium_price.hasError('max')">Maximum price should be less than or equal to 10000000000</mat-error>
    </mat-form-field>
    <mat-form-field  *ngIf="!is_splitwise.value"  class="form-group" appearance="outline">
        <mat-label>Premium Price</mat-label>
        <input  matInput type="number" formControlName="premium_price"  required>
        <span style="font-size: 15px;" matPrefix>&#x20B9; </span>
        <mat-hint>Enter a price between 1 and 100000000</mat-hint>
        <mat-error *ngIf="total_premium_price.hasError('required')">Value is required</mat-error>
        <mat-error *ngIf="total_premium_price.hasError('min')">Minimum price should be 1</mat-error>
        <mat-error *ngIf="total_premium_price.hasError('max')">Maximum price should be less than or equal to 10000000000</mat-error>
    </mat-form-field>
  
    <mat-form-field  class="form-group" appearance="outline">
        <mat-label>Total Period</mat-label>
        <input  matInput type="number" formControlName="max_time_period"  required>
        <span style="font-size: 15px;" matSuffix>{{splitwise_category.value && is_splitwise.value == true? 
            (splitwise_category.value == 'monthly' ? 'Months' :
             (splitwise_category.value == 'daily' ? 'Days' :
             (splitwise_category.value == 'weekly' ? 'Weeks' : 'Years') ) ) : 'Years'}}</span>
        <mat-hint>Enter a value between 1 and 1000000</mat-hint>
        <mat-error *ngIf="max_time_period.hasError('required')">Value is required</mat-error>
        <mat-error *ngIf="max_time_period.hasError('min')">Minimum value should be 1</mat-error>
        <mat-error *ngIf="max_time_period.hasError('max')">Maximum value should be less than or equal to 1000000</mat-error>
    </mat-form-field>
    <mat-checkbox formControlName="is_discounted_price"> Discounted Price ?</mat-checkbox><br>
    <mat-form-field *ngIf="is_discounted_price.value" class="form-group" appearance="outline">
        <mat-label>Discounted Premium Price</mat-label>
        <input  matInput type="number" formControlName="discounted_premium_price"  required>
        <span style="font-size: 15px;" matPrefix>&#x20B9; </span>
        <mat-hint>Enter a price between 1 and 100000000</mat-hint>
        <mat-error *ngIf="discounted_premium_price.hasError('required')">Value is required</mat-error>
        <mat-error *ngIf="discounted_premium_price.hasError('min')">Minimum price should be 1</mat-error>
        <mat-error *ngIf="discounted_premium_price.hasError('invalidDiscountAmt')">
            Discount amount should be less than total premium value
        </mat-error>
    </mat-form-field>
    <mat-form-field *ngIf="is_discounted_price.value" class="form-group" appearance="outline" required>
            <mat-label>Discount valid upto</mat-label>
            <input [min]="minDate" matInput formControlName="discount_valid_upto"  placeholder="Choose a date" [matDatepicker]="datepicker">
            <mat-datepicker-toggle  matSuffix [for]="datepicker"></mat-datepicker-toggle>
            <mat-datepicker #datepicker></mat-datepicker>                           
      </mat-form-field><br>
    <button type="submit" class="action-button" [disabled]="!enabledAddPremiumSave()"
     mat-raised-button color="primary" (click)="addPremium()">Save</button>
</form>
<br>
<h1 class="subscriptions"> Premium(s) </h1>
<hr>
<br>
<div class="container">
    <div class="row">
        <div class="col-lg-6 col-xl-6 col-sm-6 col-md-6" *ngFor="let premium of premiumList">
            <mat-card class="premium-card">
                <mat-card-header>
                    <div *ngIf="premium.discounted_premium_price != '' || 
                    premium.discounted_premium_price != 0" mat-card-avatar>
                        <button class="discount_percentage" mat-fab color="warn">{{premium.is_splitwise ? (((premium.total_premium_price - premium.discounted_premium_price)/premium.total_premium_price)*100).toFixed(1) :
                                (((premium.premium_price - premium.discounted_premium_price)/premium.premium_price)*100).toFixed(1)  }} %</button>
                    </div>
                    <mat-card-title>
                            <span style="margin-right: 5px;">{{premium.premium_name}}</span>
                    </mat-card-title>
                    
                    <mat-card-subtitle>
                        {{premium.premium_description}}
                    </mat-card-subtitle>
                </mat-card-header>
                <mat-card-content>
                    <span><button mat-button color="primary">
                        <mat-icon>calendar_today</mat-icon>
                    </button>
                    {{premium.splitwise_category && premium.is_splitwise == true? 
                        (premium.splitwise_category == 'monthly' ? 'Monthly' :
                         (premium.splitwise_category == 'daily' ? 'Daily' :
                         (premium.splitwise_category == 'weekly' ? 'Weekly' : 'Yearly') ) ) : 'Yearly'}}
                </span><br>
                <span *ngIf="premium.is_splitwise != true">
                        <button mat-button color="primary">
                                <mat-icon>done</mat-icon></button>
                                <span *ngIf="premium.is_discounted_price == false">&#x20B9; {{premium.premium_price}} </span>
                                <span  *ngIf="premium.is_discounted_price == true"
                                style="color: gray; font-size: 15px; text-decoration: line-through;"
                                >&#x20B9; {{premium.premium_price}}</span> 
                                <span *ngIf="premium.is_discounted_price == true">&#x20B9; {{premium.is_discounted_price ? premium.discounted_premium_price : ''}}</span>
                </span><br>
                <span *ngIf="premium.is_splitwise != true">
                        <button mat-button color="primary">
                                <mat-icon>done</mat-icon></button>
                                {{premium.max_time_period}} Year(s)     
                </span><br>
                <span *ngIf="premium.is_splitwise == true"><button mat-button color="primary">
                    <mat-icon>done</mat-icon></button>
                    &#x20B9; {{premium.splitwise_price}} / {{premium.splitwise_category && premium.is_splitwise == true? 
                        (premium.splitwise_category == 'monthly' ? 'Month' :
                         (premium.splitwise_category == 'daily' ? 'Day' :
                         (premium.splitwise_category == 'weekly' ? 'Week' : 'Year') ) ) : 'Year'}}
                
                </span><br>
                <span *ngIf="premium.is_splitwise == true"><button mat-button color="primary">
                        <mat-icon>done</mat-icon></button>
                         <span  *ngIf="premium.is_discounted_price == false"> &#x20B9; {{premium.total_premium_price}}</span> 
                        <span  *ngIf="premium.is_discounted_price == true"
                        style="color: gray; font-size: 15px; text-decoration: line-through;"
                        >&#x20B9; {{premium.total_premium_price}}</span> 
                        <span *ngIf="premium.is_discounted_price == true">&#x20B9;</span>
                        {{premium.is_discounted_price ? premium.discounted_premium_price : ''}} / {{premium.max_time_period}}
                         {{premium.splitwise_category && premium.is_splitwise == true? 
                            (premium.splitwise_category == 'monthly' ? 'Month(s)' :
                             (premium.splitwise_category == 'daily' ? 'Day(s)' :
                             (premium.splitwise_category == 'weekly' ? 'Week' : 'Year(s)') ) ) : 'Year(s)'}}
                    
                    </span>

                </mat-card-content>
                <mat-card-actions>
                    <button mat-button (click)="openModal(edit_premium,premium.premium_id)"
                     color="primary" style="margin-right : 5px;"> <mat-icon>edit</mat-icon> Edit</button>
                    <button mat-button (click)="removePremium(premium.premium_id)"
                     color="warn" style="margin-right : 5px;"> <mat-icon>close</mat-icon> Remove</button>
                </mat-card-actions>

            </mat-card>
            
        </div>
    </div>
</div>


<!-- Edit Premium Modal -->
 <ng-template id="edit-premium" #edit_premium let-c="close" let-d="dismiss">
        <h2 mat-dialog-title>Edit Premium</h2>
        <div mat-dialog-content>
        
                <form [formGroup]="addPremiumForm" ngSubmit="addPremium()">
                        <mat-form-field class="form-group" appearance="outline" style="width : 90%">
                            <mat-label>Premium Name</mat-label>
                            <input matInput formControlName="premium_name" placeholder="Enter your premium name" required >
                            <mat-hint>Premium name should not exceed 50 characters</mat-hint>
                            <mat-hint align="end">{{premium_name.value.length}}/50</mat-hint>
                            <mat-error *ngIf="premium_name.hasError('required')">Value is required</mat-error>
                            <mat-error *ngIf="premium_name.hasError('maxLength')">Max Character Limit Exceeded</mat-error>
                        </mat-form-field><br>
                        <mat-form-field class="form-group" appearance="outline" style="width : 90%">
                            <mat-label>Premium Description</mat-label>
                            <textarea matInput formControlName="premium_description" placeholder="Enter your premium description"></textarea>
                            <mat-hint>Premium name should not exceed 100 characters</mat-hint>
                            <mat-hint align="end">{{premium_description.value.length}}/100</mat-hint>
                            <mat-error *ngIf="premium_description.hasError('maxLength')">Max Character Limit Exceeded</mat-error>
                        </mat-form-field><br>
                        <mat-checkbox formControlName="is_splitwise">Is Premium Splitwise ?</mat-checkbox><br>
                        <mat-form-field *ngIf="is_splitwise.value" class="form-group" appearance="outline">
                            <mat-label>Splitwise Category</mat-label>
                            <mat-select formControlName="splitwise_category" required>
                                <mat-option value="daily">Daily</mat-option>
                                <mat-option value="weekly">Weekly</mat-option>
                                <mat-option value="monthly">Monthly</mat-option>
                                <mat-option value="yearly">Yearly</mat-option>
                            </mat-select>
                            <mat-error>Value is required</mat-error>
                        </mat-form-field>
                        <mat-form-field *ngIf="is_splitwise.value" class="form-group" appearance="outline">
                            <mat-label>
                                Splitwise Price
                            </mat-label>
                            <input matInput type="number" formControlName="splitwise_price"  required>
                            <span style="font-size: 15px;" matPrefix>&#x20B9; </span>
                            <mat-hint>Enter {{splitwise_category.value}} price between 1 and 100000000</mat-hint>
                            <mat-error *ngIf="splitwise_price.hasError('required')">Value is required</mat-error>
                            <mat-error *ngIf="splitwise_price.hasError('min')">Minimum price should be 1</mat-error>
                            <mat-error *ngIf="splitwise_price.hasError('max')">Maximum price should be less than or equal to 100000000</mat-error>
                        </mat-form-field>
                        <mat-form-field  *ngIf="is_splitwise.value"  class="form-group" appearance="outline">
                            <mat-label>Total Premium Price</mat-label>
                            <input  matInput type="number" formControlName="total_premium_price"  required>
                            <span style="font-size: 15px;" matPrefix>&#x20B9; </span>
                            <mat-hint>Enter a price between 1 and 100000000</mat-hint>
                            <mat-error *ngIf="total_premium_price.hasError('required')">Value is required</mat-error>
                            <mat-error *ngIf="total_premium_price.hasError('min')">Minimum price should be 1</mat-error>
                            <mat-error *ngIf="total_premium_price.hasError('max')">Maximum price should be less than or equal to 10000000000</mat-error>
                        </mat-form-field>
                        <mat-form-field  *ngIf="!is_splitwise.value"  class="form-group" appearance="outline">
                            <mat-label>Premium Price</mat-label>
                            <input  matInput type="number" formControlName="premium_price"  required>
                            <span style="font-size: 15px;" matPrefix>&#x20B9; </span>
                            <mat-hint>Enter a price between 1 and 100000000</mat-hint>
                            <mat-error *ngIf="total_premium_price.hasError('required')">Value is required</mat-error>
                            <mat-error *ngIf="total_premium_price.hasError('min')">Minimum price should be 1</mat-error>
                            <mat-error *ngIf="total_premium_price.hasError('max')">Maximum price should be less than or equal to 10000000000</mat-error>
                        </mat-form-field>
                      
                        <mat-form-field  class="form-group" appearance="outline">
                            <mat-label>Total Period</mat-label>
                            <input  matInput type="number" formControlName="max_time_period"  required>
                            <span style="font-size: 15px;" matSuffix>{{splitwise_category.value && is_splitwise.value == true? 
                                (splitwise_category.value == 'monthly' ? 'Months' :
                                 (splitwise_category.value == 'daily' ? 'Days' :
                                 (splitwise_category.value == 'weekly' ? 'Weeks' : 'Years') ) ) : 'Years'}}</span>
                            <mat-hint>Enter a value between 1 and 1000000</mat-hint>
                            <mat-error *ngIf="max_time_period.hasError('required')">Value is required</mat-error>
                            <mat-error *ngIf="max_time_period.hasError('min')">Minimum value should be 1</mat-error>
                            <mat-error *ngIf="max_time_period.hasError('max')">Maximum value should be less than or equal to 1000000</mat-error>
                        </mat-form-field>
                        <mat-checkbox  formControlName="is_discounted_price"> Discounted Price ?</mat-checkbox><br>
                        <mat-form-field *ngIf="is_discounted_price.value" class="form-group" appearance="outline">
                            <mat-label>Discounted Premium Price</mat-label>
                            <input  matInput type="number" formControlName="discounted_premium_price"  required>
                            <span style="font-size: 15px;" matPrefix>&#x20B9; </span>
                            <mat-hint>Enter a price between 1 and 100000000</mat-hint>
                            <mat-error *ngIf="discounted_premium_price.hasError('required')">Value is required</mat-error>
                            <mat-error *ngIf="discounted_premium_price.hasError('min')">Minimum price should be 1</mat-error>
                            <mat-error *ngIf="discounted_premium_price.hasError('invalidDiscountAmt')">
                                    Discount amount should be less than total premium value
                                </mat-error>
                        </mat-form-field>
                        <mat-form-field *ngIf="is_discounted_price.value" class="form-group" appearance="outline" required>
                                <mat-label>Discount valid upto</mat-label>
                                <input [min]="minDate" matInput formControlName="discount_valid_upto"  placeholder="Choose a date" [matDatepicker]="datepicker">
                                <mat-datepicker-toggle  matSuffix [for]="datepicker"></mat-datepicker-toggle>
                                <mat-datepicker #datepicker></mat-datepicker>                           
                          </mat-form-field><br>
                        <!--button type="submit" class="action-button" [disabled]="!enabledAddPremiumSave()"
                         mat-raised-button color="primary" (click)="updatePremium()">Save</button-->
                    </form>
         
        </div>
        <div mat-dialog-actions>
          <button mat-raised-button color="primary" (click)="updatePremium()" [disabled]="!enabledAddPremiumSave()"
         mat-dialog-close> Save</button>
         <button mat-raised-button color="warn"
         mat-dialog-close> Close</button>
        </div>
        
      </ng-template>





<div  *ngIf="showLoader" class="loader">
    <mat-spinner color="primary"></mat-spinner><br>
    <span style="color: white; position: fixed; top:400px">Loading ...</span>
    </div>
