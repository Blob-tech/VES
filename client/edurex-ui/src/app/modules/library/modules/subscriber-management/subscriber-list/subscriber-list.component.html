<div class="alert alert-info alert-dismissible fade-in" [hidden] = " noSubs ? false : true">
    <strong>Alert!</strong> {{noSubs}}
  </div>
  
  
  <div [hidden] = " noSubs ? true : false">
<mat-paginator *ngIf = "subscriberList.length > 0"
    (page)="handlePageEvent($event)"
    [length]="length"
    [pageSize]="pageSize"
    [pageSizeOptions]="pageSizeOptions">
  </mat-paginator>
<br>
<mat-slide-toggle class="only-active"[(ngModel)]="onlyActive" (click)="only_active_user()"><b>Only Active Institute/Organisation</b> </mat-slide-toggle>
<button style="margin-left: 15px;" (click) = "toggle_view()" *ngIf="userView == 'LIST'" mat-mini-fab matTooltip="GRID VIEW" color="primary"><mat-icon>window</mat-icon></button>
<button style="margin-left: 15px;" (click) = "toggle_view()" *ngIf="userView == 'GRID'"  mat-mini-fab matTooltip="LIST VIEW" color="primary"><mat-icon>list</mat-icon></button>

  <div *ngIf="userView == 'GRID'" class="container">
    <div class="row">
      <div style="margin-top: 1rem; padding-top: 1rem ; " class="col-md-6 col-lg-6 col-sm-3 col-xs-6 col-xl-6" *ngFor= "let user of subscriberList">
        <app-profile-grid [selectedUser] = "user" 
        [enabledSubtitle] = true></app-profile-grid><br>
        <button [disabled]="!user.isActivated" matTooltip="view" (click)="open(user,viewProfile)" mat-mini-fab class="action-button" color="primary" ><i class="fas fa-eye"></i></button>
      <button [disabled]="!user.isActivated" matTooltip="edit"  mat-mini-fab class="action-button" color="accent" ><i class="fas fa-edit"></i></button>
      <button [disabled]="!user.isActivated" matTooltip="delete" (click)="delete_user(user.user_id)" mat-mini-fab class="action-button" color="warn"><i class="fas fa-trash"></i></button>
      <app-manage-access style="margin-right: 1rem;"  [disabled]="!user.isActivated" [access_id]="user.user_id"></app-manage-access>
      <mat-slide-toggle [(ngModel)]="user.isActivated" (click)="deactivate_user(user.isActivated,user.user_id)">{{user.isActivated ? "Active" : "Inactive"}}</mat-slide-toggle>
    </div>
    </div>

  </div>
  <br>
  <mat-form-field *ngIf="userView == 'LIST'" appearance="outline" style="margin-left: 15%; margin-right: 10px;  width : 40%">
    <mat-label>Bulk Action</mat-label>
    <mat-select [(ngModel)]="bulkaction">
      <mat-option value="DELETE">Delete</mat-option>
      <mat-option value="DEACTIVATE">Deactivate</mat-option>
      <mat-option value="ACTIVATE">Activate</mat-option>
      <mat-option value="ACCESS">Manage Access</mat-option>
    </mat-select>
  </mat-form-field>
  
  <button *ngIf="userView == 'LIST'" style="margin-right : 10px" mat-raised-button color="primary" [disabled]="bulkaction == '' || selection.selected.length == 0"
  (click)="bulk_action(bulkaction)">Apply</button><br>
  
<!--mat-form-field *ngIf="bookView == 'LIST'"  appearance="outline" style="margin-left: 15%; margin-right: 10px;  width : 40%">
    <mat-label>Bulk Action</mat-label>
    <mat-select [(ngModel)]="bulkaction">
      <mat-option value="DELETE">Delete</mat-option>
    </mat-select>
  </mat-form-field>

  <button *ngIf="bookView == 'LIST'" style="margin-right : 10px" mat-raised-button color="primary" [disabled]="bulkaction == '' || selection.selected.length == 0"
  (click)="bulk_action(bulkaction)">Apply</button-->
  <table *ngIf="userView == 'LIST'"  id="UserTable" matSort  mat-table [dataSource]="dataSource" class="mat-elevation-z8 board-table">

    <ng-container matColumnDef="select">
        <th mat-header-cell *matHeaderCellDef>
          <mat-checkbox (change)="$event ? masterToggle() : null"
                        [checked]="selection.hasValue() && isAllSelected()"
                        [indeterminate]="selection.hasValue() && !isAllSelected()"
                        [aria-label]="checkboxLabel()">
          </mat-checkbox>
        </th>
        <td mat-cell *matCellDef="let row">
          <mat-checkbox (click)="$event.stopPropagation()"
                        (change)="$event ? selection.toggle(row) : null"
                        [checked]="selection.isSelected(row)"
                        [aria-label]="checkboxLabel(row)">
          </mat-checkbox>
        </td>
      </ng-container>
  
  <ng-container matColumnDef="user_id">
  <th mat-header-cell *matHeaderCellDef mat-sort-header > Id </th>
  <td [style.color]="user.isActivated ? '' : 'grey'" mat-cell *matCellDef="let user"> {{user.user_id}} </td>
  </ng-container>
  
  
  <ng-container matColumnDef="user_name">
  <th mat-header-cell *matHeaderCellDef mat-sort-header> Name </th>
  <td [style.color]="user.isActivated ? '' : 'grey'" mat-cell *matCellDef="let user">
      <img [style.opacity]="!user.isActivated ? 0.2 : 1"
      src= "{{user.avatar ? imgUrl + user.avatar : '/assets/images/user.png'}}" height=60 width = 60
      style="border-radius : 50%;" >
     {{user.name}} </td>
  </ng-container>

  <ng-container matColumnDef="email">
    <th mat-header-cell *matHeaderCellDef mat-sort-header > Email </th>
    <td [style.color]="user.isActivated ? '' : 'grey'" mat-cell *matCellDef="let user"> {{user.email}} </td>
    </ng-container>

    <ng-container matColumnDef="phone">
      <th mat-header-cell *matHeaderCellDef mat-sort-header > Contact </th>
      <td [style.color]="user.isActivated ? '' : 'grey'" mat-cell *matCellDef="let user"> {{user.phone}} </td>
      </ng-container>
  
  <ng-container matColumnDef="actions">
    <th mat-header-cell *matHeaderCellDef> Actions </th>
    <td mat-cell *matCellDef="let user">
      <button [disabled]="!user.isActivated" matTooltip="view" (click)="open(user,viewProfile)" mat-mini-fab class="action-button" color="primary" ><i class="fas fa-eye"></i></button>
      <button [disabled]="!user.isActivated" matTooltip="edit"  mat-mini-fab class="action-button" color="accent" ><i class="fas fa-edit"></i></button>
      <button [disabled]="!user.isActivated" matTooltip="delete" (click)="delete_user(user.user_id)" mat-mini-fab class="action-button" color="warn"><i class="fas fa-trash"></i></button>
       </td>
    </ng-container>

    <ng-container matColumnDef="access">
      <th mat-header-cell *matHeaderCellDef> Manage Access </th>
      <td mat-cell *matCellDef="let user">
        <app-manage-access [disabled]="!user.isActivated" [access_id]="user.user_id"></app-manage-access>
         </td>
      </ng-container>
  
    <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef> Status </th>
        <td mat-cell *matCellDef="let user">
          <mat-slide-toggle [(ngModel)]="user.isActivated" (click)="deactivate_user(user.isActivated,user.user_id)">{{user.isActivated ? "Active" : "Inactive"}}</mat-slide-toggle>
           </td>
        </ng-container>
  
  
  
  <tr mat-header-row *matHeaderRowDef="displayedColumns;sticky: true"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>

<br>

  <mat-paginator *ngIf = "subscriberList.length > 0"
  (page)="handlePageEvent($event)"
  [length]="length"
  [pageSize]="pageSize"
  [pageSizeOptions]="pageSizeOptions">
</mat-paginator>
<br>
</div>

<!-- view profile modal-->
<ng-template #viewProfile> 
 <h1 mat-dialog-title></h1>
  <div mat-dialog-content>
       <app-profile-grid [selectedUser]="selectedUser"></app-profile-grid>      
  </div>
  <div mat-dialog-actions>
    <button mat-raised-button color="warn" mat-dialog-close>Close</button>
  </div>
  
</ng-template>


  